{% extends 'template.html' %}

{% block title %} Login {% endblock %}

{% block mainBody %}
    <div class="loginPage">
        <h1>Login Page</h1>

        <div id="g_id_onload"
            data-client_id="268607576142-fji5gsrr48196i4kd4ce6e20al1nrl44.apps.googleusercontent.com"
            data-ux_mode="redirect"
            data-login_uri="/menu/">
        </div>
        <div class="g_id_signin" data-type="standard"></div>

        <script>
            function onSuccess(googleUser) {
                console.log('Logged in as: ' + googleUser.getBasicProfile().getName());
                updateCheckSignedIn();
                redirect();
            }

            function onFailure(error) {
                console.log(error);
            }

            function renderButton() {
                gapi.signin2.render('my-signin2', {
                    'scope': 'profile email',
                    'width': 240,
                    'height': 50,
                    'longtitle': true,
                    'theme': 'dark',
                    'onsuccess': onSuccess,
                    'onfailure': onFailure
                });
            }
            
            function signOut() {
                var auth2 = gapi.auth2.getAuthInstance();
                auth2.signOut().then(function () {
                    console.log('User signed out.');
                    updateCheckSignedIn();
                });
            }

            function loadSite() {
                renderButton();
            }
            
            function updateCheckSignedIn() {
                if (gapi.auth2.getAuthInstance().isSignedIn.ee == false) {
                    document.getElementById("my-signin2").style.display = "block";
                    document.getElementById("logoutButton").style.display = "none";
                } else {
                    document.getElementById("my-signin2").style.display = "none";
                    document.getElementById("logoutButton").style.display = "block";
                }
            }

            function redirect() {
                window.location.href = '/menu/'
            }
        </script>

        <script src="https://accounts.google.com/gsi/client" async defer></script>
    </div>
{% endblock %}